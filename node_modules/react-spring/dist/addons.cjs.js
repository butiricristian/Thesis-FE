"use strict";function t(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function t(){}var n=t.prototype;return n.start=function(t,n,i,e){},n.stop=function(){},n.__debouncedOnEnd=function(t){var n=this.__onEnd;this.__onEnd=null,n&&n(t)},t}(),i=4,e=.001,o=1e-7,a=10,r=11,s=1/(r-1),u="function"==typeof Float32Array;function _(t,n){return 1-3*n+3*t}function c(t,n){return 3*n-6*t}function l(t){return 3*t}function f(t,n,i){return((_(n,i)*t+c(n,i))*t+l(n))*t}function h(t,n,i){return 3*_(n,i)*t*t+2*c(n,i)*t+l(n)}function d(t,n,i,e,r){var s,u,_=0;do{(s=f(u=n+(i-n)/2,e,r)-t)>0?i=u:n=u}while(Math.abs(s)>o&&++_<a);return u}function m(t,n,e,o){for(var a=0;a<i;++a){var r=h(n,e,o);if(0===r)return n;n-=(f(n,e,o)-t)/r}return n}function p(t,n,i,o){if(!(0<=t&&t<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");var a=u?new Float32Array(r):new Array(r);if(t!==n||i!==o)for(var _=0;_<r;++_)a[_]=f(_*s,t,i);return function(u){return t===n&&i===o?u:0===u?0:1===u?1:f(function(n){for(var o=0,u=1,_=r-1;u!==_&&a[u]<=n;++u)o+=s;var c=o+(n-a[--u])/(a[u+1]-a[u])*s,l=h(c,t,i);return l>=e?m(n,c,t,i):0===l?c:d(n,o,o+s,t,i)}(u),n,o)}}var v=function(){function t(){}return t.step0=function(t){return t>0?1:0},t.step1=function(t){return t>=1?1:0},t.linear=function(t){return t},t.ease=function(t){return y(t)},t.quad=function(t){return t*t},t.cubic=function(t){return t*t*t},t.poly=function(t){return function(n){return Math.pow(n,t)}},t.sin=function(t){return 1-Math.cos(t*Math.PI/2)},t.circle=function(t){return 1-Math.sqrt(1-t*t)},t.exp=function(t){return Math.pow(2,10*(t-1))},t.elastic=function(t){void 0===t&&(t=1);var n=t*Math.PI;return function(t){return 1-Math.pow(Math.cos(t*Math.PI/2),3)*Math.cos(t*n)}},t.back=function(t){return void 0===t&&(t=1.70158),function(n){return n*n*((t+1)*n-t)}},t.bounce=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},t.bezier=function(t,n,i,e){return p(t,n,i,e)},t.in=function(t){return t},t.out=function(t){return function(n){return 1-t(1-n)}},t.inOut=function(t){return function(n){return n<.5?t(2*n)/2:1-t(2*(1-n))/2}},t}(),y=v.bezier(.42,0,1,1),V=v.inOut(v.ease),T=function(n){function i(t){var i;return(i=n.call(this)||this).onUpdate=function(){var t=Date.now();if(t>=i._startTime+i._duration)return i._onUpdate(0===i._duration?i._toValue:i._fromValue+i._easing(1)*(i._toValue-i._fromValue)),void i.__debouncedOnEnd({finished:!0});i._onUpdate(i._fromValue+i._easing((t-i._startTime)/i._duration)*(i._toValue-i._fromValue)),i.__active&&(i._animationFrame=requestAnimationFrame(i.onUpdate))},i._toValue=t.toValue,i._easing=void 0!==t.easing?t.easing:V,i._duration=void 0!==t.duration?t.duration:500,i._delay=void 0!==t.delay?t.delay:0,i}t(i,n);var e=i.prototype;return e.start=function(t,n,i){var e=this;this.__active=!0,this._fromValue=t,this._onUpdate=n,this.__onEnd=i;var o=function(){0===e._duration?(e._onUpdate(e._toValue),e.__debouncedOnEnd({finished:!0})):(e._startTime=Date.now(),e._animationFrame=requestAnimationFrame(e.onUpdate))};this._delay?this._timeout=setTimeout(o,this._delay):o()},e.stop=function(){this.__active=!1,clearTimeout(this._timeout),cancelAnimationFrame(this._animationFrame),this.__debouncedOnEnd({finished:!1})},i}(n),M=function(t,n){return void 0===t||null===t?n:t},b=function(t){return 3.62*(t-30)+194},P=function(t){return 3*(t-8)+25},U=function(t,n){return{tension:b(t),friction:P(n)}},g=function(n){function i(t){var i;(i=n.call(this)||this).onUpdate=function(){var t=Date.now();t>i._lastTime+64&&(t=i._lastTime+64);var n=(t-i._lastTime)/1e3;i._frameTime+=n;var e=i._friction,o=i._mass,a=i._tension,r=-i._initialVelocity,s=e/(2*Math.sqrt(a*o)),u=Math.sqrt(a/o),_=u*Math.sqrt(1-s*s),c=i._toValue-i._startPosition,l=0,f=0,h=i._frameTime;if(s<1){var d=Math.exp(-s*u*h);l=i._toValue-d*((r+s*u*c)/_*Math.sin(_*h)+c*Math.cos(_*h)),f=s*u*d*(Math.sin(_*h)*(r+s*u*c)/_+c*Math.cos(_*h))-d*(Math.cos(_*h)*(r+s*u*c)-_*c*Math.sin(_*h))}else{var m=Math.exp(-u*h);l=i._toValue-m*(c+(r+u*c)*h),f=m*(r*(h*u-1)+h*c*(u*u))}if(i._lastTime=t,i._lastPosition=l,i._lastVelocity=f,i._onUpdate(l),i.__active){var p=!1;i._overshootClamping&&0!==i._stiffness&&(p=i._startPosition<i._toValue?l>i._toValue:l<i._toValue);var v=Math.abs(f)<=i._restSpeedThreshold,y=!0;if(0!==i._stiffness&&(y=Math.abs(i._toValue-l)<=i._restDisplacementThreshold),p||v&&y)return 0!==i._stiffness&&(i._lastPosition=i._toValue,i._lastVelocity=0,i._onUpdate(i._toValue)),i.__debouncedOnEnd({finished:!0});i._animationFrame=requestAnimationFrame(i.onUpdate)}},i._overshootClamping=M(t.overshootClamping,!1),i._restDisplacementThreshold=M(t.restDisplacementThreshold,1e-4),i._restSpeedThreshold=M(t.restSpeedThreshold,1e-4),i._initialVelocity=M(t.velocity,0),i._lastVelocity=M(t.velocity,0),i._toValue=t.toValue;var e=U(M(t.tension,40),M(t.friction,7));return i._tension=e.tension,i._friction=e.friction,i._mass=M(t.mass,1),i._delay=void 0!==t.delay?t.delay:0,i}t(i,n);var e=i.prototype;return e.start=function(t,n,e,o){if(this.__active=!0,this._startPosition=t,this._lastPosition=this._startPosition,this._onUpdate=n,this.__onEnd=e,this._lastTime=Date.now(),this._frameTime=0,o instanceof i){var a=o.getInternalState();this._lastPosition=a.lastPosition,this._lastVelocity=a.lastVelocity,this._lastTime=a.lastTime}void 0!==this._initialVelocity&&null!==this._initialVelocity&&(this._lastVelocity=this._initialVelocity),this._delay?this._timeout=setTimeout(this.onUpdate,this._delay):this.onUpdate()},e.getInternalState=function(){return{lastPosition:this._lastPosition,lastVelocity:this._lastVelocity,lastTime:this._lastTime}},e.stop=function(){this.__active=!1,clearTimeout(this._timeout),cancelAnimationFrame(this._animationFrame),this.__debouncedOnEnd({finished:!1})},i}(n);exports.TimingAnimation=T,exports.OscillatorAnimation=g,exports.Easing=v;
